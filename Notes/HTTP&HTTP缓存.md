
## OSI 七层模型指什么
1. 物理层：主要定义物理设备标准，如网线的接口类型、光纤的接口类型、各种传输介质的传输速率等。它的主要作用是传输比特流(就是由1、0转化为电流强弱来进行传输，到达目的地后再转化为1、0，也就是我们常说的数模转换与模数转换)。这一层的数据叫做比特。

2. 数据链路层：定义了如何让格式化数据以进行传输，以及如何让控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输。

3. 网络层：在位于不同地理位置的网络中的两个主机系统之间提供连接和路径选择。Internet的发展使得从世界各站点访问信息的用户数大大增加，而网络层正是管理这种连接的层。

4. 传输层：定义了一些传输数据的协议和端口号(WWW端口80等)，如：TCP(传输控制协议，传输效率低，可靠性强，用于传输可靠性要求高，数据量大的数据)，UDP(用户数据报协议，与TCP特性恰恰相反，用于传输可靠性要求不高，数据量小的数据，如QQ聊天数据就是通过这种方式传输的）。 主要是将从下层接收的数据进行分段和传输，到达目的地址后再进行重组。常常把这一层数据叫做段。

5. 会话层：通过传输层(端口号：传输端口与接收端口)建立数据传输的通路。主要在你的系统之间发起会话或者接受会话请求(设备之间需要互相认识可以是IP也可以是MAC或者是主机名)。

6. 表示层：可确保一个系统的应用层所发送的信息可以被另一个系统的应用层读取。例如，PC程序与另一台计算机进行通信，其中一台计算机使用扩展二一十进制交换吗(EBCDIC)，而另一台则使用美国信息交换标准码（ASCII）来表示相同的字符。如有必要，表示层会通过使用一种通格式来实现多种数据格式之间的转换。

7. 应用层：是最靠近用户的OSI层。这一层为用户的应用程序(例如电子邮件、文件传输和终端仿真)提供网络服务。

   ![](http://ww1.sinaimg.cn/large/d40e9753gy1fhg11jm5jpj20v41831jz.jpg)

## HTTP 的工作原理

### HTTP简介
HTTP协议（HyperText Transfer Protocol，超文本传输协议）是一个客户端终端（用户）和服务器端（网站）请求和响应的标准（[TCP](https://zh.wikipedia.org/wiki/TCP)）。通过使用网页浏览器、网络爬虫或者其它的工具，客户端发起一个HTTP请求到服务器上指定端口（默认[端口](https://zh.wikipedia.org/wiki/%E7%AB%AF%E5%8F%A3)为80）。我们称这个客户端为用户代理程序（user agent）。应答的服务器上存储着一些资源，比如HTML文件和图像。我们称这个应答服务器为源服务器（origin server）。在用户代理和源服务器中间可能存在多个“中间层”，比如[代理服务器](https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%90%86%E4%BC%BA%E6%9C%8D%E5%99%A8)、[网关](https://zh.wikipedia.org/wiki/%E7%BD%91%E5%85%B3)或者[隧道](https://zh.wikipedia.org/wiki/%E9%9A%A7%E9%81%93)（tunnel）。

在了解HTTP如何工作之前，我们需要先了解计算机之间的通信。
### 计算机之间的通信
互联网的关键技术就是TCP/IP协议。两台计算机之间的通信是通过TCP/IP协议在因特网上进行的。实际上这是两个协议:

- **TCP :** Transmission Control Protocol 传输控制协议
- **IP:** Internet Protocol  网际协议。

**IP：计算机之间的通信**
IP协议是计算机用来相互识别的通信的一种机制，每台计算机都有一个IP用来在internet上标识这台计算机。  IP 负责在因特网上发送和接收数据包。通过 IP，消息（或者其他数据）被分割为小的独立的包，并通过因特网在计算机之间传送。IP 负责将每个包路由至它的目的地。

IP协议仅仅是允许计算机相互发消息，但它并不检查消息是否以发送的次序到达而且没有损坏（只检查关键的头数据）。为了提供消息检验功能，直接在IP协议上设计了传输控制协议TCP.

**TCP : 应用程序之间的通信**
TCP确保数据包以正确的次序到达，并且尝试确认数据包的内容没有改变。TCP在IP地址之上引端口（port），它允许计算机通过网络提供各种服务。

当应用程序希望通过 TCP 与另一个应用程序通信时，它会发送一个通信请求。这个请求必须被送到一个确切的地址。在双方“握手”之后，TCP 将在两个应用程序之间建立一个全双工 (full-duplex) 的通信，占用两个计算机之间整个的通信线路。TCP 用于从应用程序到网络的数据传输控制。TCP 负责在数据传送之前将它们分割为 IP 包，然后在它们到达的时候将它们重组。

TCP/IP 就是TCP 和 IP 两个协议在一起协同工作，有上下层次的关系。

TCP 负责应用软件（比如你的浏览器）和网络软件之间的通信。IP 负责计算机之间的通信。TCP 负责将数据分割并装入 IP 包，IP 负责将包发送至接受者，传输过程要经IP路由器负责根据通信量、网络中的错误或者其他参数来进行正确地寻址，然后在它们到达的时候重新组合它们。

基于HTTP协议的客户(C)/服务器(S)模式的信息交换过程，分为四个过程：建立连接、发送请求信息、发送响应信息、关闭连接。

### HTTP工作过程
一次HTTP操作称为一个事物，整个工作过程如下:
以访问`https://www.google.co.jp/?gfe_rd=cr&ei=7pVcWfe0Guzd8Afx_JGQCg`为例
**1. 域名解析:** 从URL中解析出协议类型、主机名、端口、向服务端发送的参数，通过域名系统DNS解析域名得到IP地址。
**2. 封装HTTP请求数据包:** 把上面解析得到的信息结合本机信息封装成一个HTTP请求数据包。
**3. 封装成TCP包，建立TCP 连接:** 在HTTP开始工作之前，客户端首先要与服务端建立连接，该连接是通过TCP来完成的，该协议与IP协议共同构建Internet,即TCP/IP协议族，HTTP是比TCP更高层次的应用层协议，根据规则，只有低层协议建立之后才能，才能进行更高层协议的连接，因此，首先要建立TCP连接，一般TCP连接的端口号是80。
**4. 客户端发送请求命令:** 连接后，客户机发送一个请求给服务器，请求方式的格式为:URL（统一资源定位符）、协议版本号，后边是MIME信息，包括请求修饰符、客户端信息。
**5. 服务器响应:** 服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息包括服务器信息、实体信息和可能的内容。
**6. 一般情况下，**一旦web服务器向浏览器发送了请求数据，它就要关闭TCP连接，如果览器或者服务器在其头信息加入了Connection:keep-alive，这样TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了网络带宽。

服务器将响应信息传给客户端，响应体中的内容可能是一个html页面，也可能是一张图片，通过输入流将其读出，并显示到显示器上。

## URL 的格式是什么？常见的协议有哪些

通用的URL由9部分组成

```
<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<hash>
```

对于web页面来说最常用的协议就是http和https

**user**和**password**现在不常见了，不会在URL明文书写用户名和密码了，都是通过登录的方式

主机可以是IPO地址或者域名

端口号用来区分主机上的进程，方便找到web服务器，http默认是80

**path**是资源的路径，也就是存放位置，不一定和物理路径完全对应，符合web服务器路由约定即可

**params**在一些协议中需要参数来访问资源，例如ftp是二进制还是文本传输，参数是名值对，用;隔开

**query**是get请求最常用的传递参数方式了 ?a=1&b=2&=3

**hash**也称为片段，设计为标识文档的一部分，很多MVVM框架用作了路由功能

#### 常见的网络协议
1.IP协议:互联网协议

主要用于负责IP寻址、路由选择和IP数据包的分割和组装。通常我们所说的IP地址可以理解为符合IP协议的地址。

2.TCP协议:传输控制协议


    该协议主要用于在主机间建立一个虚拟连接,以实现高可靠性的数据包交换。IP协议可以进行IP数据包的分割和组装,但是通过IP协议并不能清楚地了解到数据包是否顺利地发送给目标计算机。而使用TCP协议就不同了,在该协议传输模式中在将数据包成功发送给目标计算机后,TCP会要求发送一个确认；如果在某个时限内没有收到确认,那么TCP将重新发送数据包。另外,在传输的过程中,如果接收到无序、丢失以及被破坏的数据包,TCP还可以负责恢复。
3.FTP（File Transfer Protocol）:远程文件传输协议，允许用户将远程主机上的文件拷贝到自己的计算机上。

4.HTTP:超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的WWW文件都必须遵守这个标准。设计HTTP最初的目的是为了提供一种发布和接收HTML页面的方法。

5.ARP协议:AddressResolutionProtocol地址解析协议

简单地说,ARP协议主要负责将局域网中的32为IP地址转换为对应的48位物理地址,即网卡的MAC地址。



## HTTP 协议有几种和服务器交互的方法
**HTTP最大的作用就是客户端发送请求，服务器给出响应，客户端向服务器发送请求的方式有很多**

### GET

GET是最常用的方法，通常用于请求服务器发送某个资源

我们平时在浏览器输入网页地址，就是给服务器发送了一个get请求，希望得到这个网页

### HEAD

HEAD方法和GET类似，但是在服务器的响应中没有资源的内容，只有资源的一些基本信息，主要用于

在不获取资源的情况下获取资源信息（类型、大小等）

通过状态码产看资源是否存在

通过查看首部，测试资源是否被修改了

### PUT

和GET从服务器获取资源相反，PUT用于向服务器写入资源。PUT的语义就是让服务器用请求的主体部分创建一个请求URL命名的文档，如果存在就替换

当然处于安全原因，并不是所有的服务器都实现，当然最近大热的RESTful API使它有了用武之地

### POST

POST用于想服务器发送数据，通常用来支持HTML的表单（input、select、textarea），表单中的数据会被发送到服务器

### TRACE

客户端发送一个请求的时候，这个请求可能会穿过防火墙、代理、网关和一些其它应用程序，每个中间节点都有可能修改HTTP请求，TRACE方法允许客户端在最终请求发往服务器的时候，看看它变成了什么样子

TRACE请求会在目的服务器端发送一个“闭环”诊断，行程最后一站服务器会弹回一条TRACE响应，并在响应主题中携带它收到的原始请求报文

### DELETE

DELETE方法用于要求服务器删除请求的URL，和PUT一样，服务器可能会不支持

### OPTIONS

OPTIONS方法用于请求 web服务器告知其支持的各种功能

## 状态码200，301，304，403,404,500，503分别代表什么意思


| 状态代码 |         状态信息          | 含义                                       |
| :--: | :-------------------: | :--------------------------------------- |
| 200  |          OK           | 一切正常，对GET和POST请求的应答文档跟在后面                |
| 301  |   Moved Permanently   | 客户请求的文档在其他地方，新的URL在Location头中给出，浏览器应该自动地访问新的URL |
| 304  |     Not Modified      | 客户端有缓冲的文档并发出了一个条件性的请求（一般是提供If-Modified-Since头表示客户只想比指定日期更新的文档）。服务器告 诉客户，原来缓冲的文档还可以继续使用。 |
| 403  |       Forbidden       | 资源不可用,服务器理解客户的请求，但拒绝处理它。通常由于服务器上文件或目录的权限设置导致 |
| 404  |       Not Found       | 无法找到指定位置的资源。这也是一个常用的应答                   |
| 500  | Internal Server Error | 服务器遇到了意料不到的情况，不能完成客户的请求。                 |
| 503  |  Service Unavailable  | 服务器由于维护或者负载过重未能应答。例如，Servlet可能在数据库连接池已满的情况下返回503。服务器返回503时可以提供一个 Retry-After头 |


## 报文有哪几部分组成？

HTTP报文是简单的格式化数据块，每个报文都包含一条来自客户端的请求或者一条来自服务器的响应，由3个部分组成

对报文进行描述的起始行 —— start line
包含属性的首部块 —— header
可选的包含数据的主体部分 —— body

```javascript
HTTP/1.0 200 OK				//start line
content-type: text/plain
content-length: 19 			//header

Hi, I'm a message 			//body
```
起始行和首部就是由行分隔的ASCII文本，主题是一个可选的数据块，可能是文本、二进制或者空

## 请求头的格式和作用是什么？给个范例截图说明

## 首部的格式和作用是什么？给个范例截图说明

## 主体的作用是什么？给个范例

主体就是客户端和服务端之间传输的主要数据内容

主体可以是很多类型的数据，包括图片、视频、HTML文档、软件应用程序等

![](http://ww1.sinaimg.cn/large/d40e9753gy1fhg1ofs3ipj211s0hs45c.jpg)

## 简述浏览器缓存是如何控制的

#### 缓存的作用

**减少网络带宽消耗**:无论对于网站运营者或者用户，带宽都代表着金钱，过多的带宽消耗，只会便宜了网络运营商。当Web缓存副本被使用时，只会产生极小的网络流量，可以有效的降低运营成本。

**降低服务器压力**:给网络资源设定有效期之后，用户可以重复使用本地的缓存，减少对源服务器的请求，间接降低服务器的压力。同时，[搜索引擎](http://lib.csdn.net/base/searchengine)的爬虫[机器人](http://lib.csdn.net/base/robot)也能根据过期机制降低爬取的频率，也能有效降低服务器的压力。

**减少网络延迟，加快页面打开速度**:带宽对于个人网站运营者来说是十分重要，而对于大型的互联网公司来说，可能有时因为钱多而真的不在乎。那Web缓存还有作用吗？答案是肯定的，对于最终用户，缓存的使用能够明显加快页面打开速度，达到更好的体验

#### 强制缓存

浏览器在请求已经访问过的URL的时候, 会判断是否使用缓存, 判断是否使用缓存主要通过判断缓存是否在有效期内, 通过两个字段来判断:

- Expires, 有效期, 返回的是一个GMT时间，**这是一个绝对时间**, 但是使用的是客户端时间, 与服务器时间存在一定时间差
- Cache-Control => max-age, 最大有效时间,**这是一个相对时间**, 单位是s, 优先级比expires高, 为了解决expires时间差的问题而出现的



#### 对比缓存

当缓存过期后, 浏览器不会直接去服务器上拿缓存, 而是判断缓存是否有更新, 能否继续使用, 判断的方法有两种:

- Last-Modified 和 If-Modified-Since: 服务器会响应一个Last-Modified字段, 表示最近一次修改缓存的时间, 当缓存过期后, 浏览器就会把这个时间放在If-Modified-Since去请求服务器, 判断缓存是否有更新
- Etag和If-None-Match: 服务器会响应一个Etag字段, 一个表示文件唯一的标识符, 一旦文件更新, Etag也会跟着更改, 当缓存过期后, 浏览器会把这个唯一标识符放在If-None-Match去请求服务器, 判断是否有更新, Etag的优先级比Last-Modified的更高





#### 那么既生Last-Modified何生Etag？你可能会觉得使用Last-Modified已经足以让浏览器知道本地的缓存副本是否足够新，为什么还需要Etag（实体标识）呢？HTTP1.1中Etag的出现主要是为了解决几个Last-Modified比较难解决的问题

- Last-Modified标注的最后修改只能精确到秒级，如果某些文件在1秒钟以内，被修改多次的话，它将不能准确标注文件的修改时间


- 如果某些文件会被定期生成，当有时内容并没有任何变化，但Last-Modified却改变了，导致文件没法使用缓存
- 有可能存在服务器没有准确获取文件修改时间，或者与代理服务器时间不一致等情形

[知乎专栏-浏览器是如何控制缓存的](https://zhuanlan.zhihu.com/p/23299600?refer=study-fe)